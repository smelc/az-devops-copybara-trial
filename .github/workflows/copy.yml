name: copy
on:
  pull_request:
  push:
    branches: main # Comment this line if you want to test the CI before opening a PR

jobs:
  ci:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Azure Login
        uses: azure/login@v1
        with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}
      - name: Azure configuration
        run: |
          az devops configure --defaults organization=https://dev.azure.com/kaiko-azure-devops/
          az devops configure --defaults project=kaiko-copybara-trial
      - name: az account show
        run: |
          az account show
      - name: az devops PAT login
        env:
          AZURE_PAT: ${{ secrets.AZURE_PAT }}
        run: |
          echo "$AZURE_PAT" | az devops login
      - name: az repos prs list
        run: |
          az repos pr list
